import cv2
import matplotlib.pyplot as plt

def draw_yolo_boxes(txt_path, img_path):
    # Read the bounding box data from the text file
    with open(txt_path, 'r') as file:
        lines = file.readlines()

    # Load the image
    image = cv2.imread(img_path)
    img_height, img_width, _ = image.shape

    # Process each line in the text file
    for line in lines:
        parts = line.strip().split()
        if len(parts) >= 5:
            # Extract data
            class_id = int(parts[0])
            x_center_rel = float(parts[1])
            y_center_rel = float(parts[2])
            width_rel = float(parts[3])
            height_rel = float(parts[4])

            # Convert to absolute coordinates
            x_center = int(x_center_rel * img_width)
            y_center = int(y_center_rel * img_height)
            width = int(width_rel * img_width)
            height = int(height_rel * img_height)

            # Calculate the top-left corner of the bounding box
            x_min = int(x_center - width / 2)
            y_min = int(y_center - height / 2)

            # Draw rectangle on image
            cv2.rectangle(image, (x_min, y_min), (x_min + width, y_min + height), (255, 0, 0), 2)

    # Convert image from BGR to RGB
    image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
    plt.imshow(image_rgb)
    plt.axis('off')
    plt.show()

# Usage
# draw_yolo_boxes('path_to_your_txt_file.txt', 'path_to_your_image.jpg')

