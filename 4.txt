
from flask import Flask, request, jsonify
import csv
from io import StringIO

app = Flask(__name__)

@app.route('/upload-csv', methods=['POST'])
def upload_csv():
    if 'file' not in request.files:
        return "No file part in the request", 400

    file = request.files['file']
    if file.filename == '':
        return "No file selected", 400

    if file and file.filename.endswith('.csv'):
        try:
            string_file = StringIO(file.stream.read().decode("utf-8"), newline=None)
            csv_reader = csv.reader(string_file, delimiter=',')
            result = list(csv_reader)
            return jsonify(result)
        except Exception as e:
            return str(e), 500

    return "Unsupported file type", 400

if __name__ == '__main__':
    app.run(debug=True)



import requests

# URL 指向你的 Flask 应用的上传接口
url = 'http://127.0.0.1:5000/upload-csv'

# CSV 文件的本地路径
file_path = 'path_to_your_file.csv'

# 打开文件并上传
with open(file_path, 'rb') as f:
    files = {'file': (file_path, f)}
    # 如果需要传递额外的数据，可以使用 params 或 data 参数
    response = requests.post(url, files=files)

# 打印服务器的响应
print(response.text)

